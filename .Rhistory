##############################################################################################################
# TO DO: calculate variance-covariance matrix, esp covariance for between LUI comparisons
#  VCov_matrix <-
rma.mv.fit <- rma.mv(yi=yi, V=vi, mods = mods, random = ~inner2|outer2, struct="CS", data=ES.frame, slab=slab,method="REML", tdist=FALSE, level=95, digits=4, Rscale="cor", sparse=FALSE, verbose=FALSE)
return(rma.mv.fit)
}
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR, vi=Richness.Log.RR.Var, mods=~1, slab=paste(Study.Case, Low.LUI,High.LUI,sep="_"), inner2=ES.frame$Case.ID, outer2=ES.frame$Study.ID)
attach(ES.frame)
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR, vi=Richness.Log.RR.Var, mods=~1, slab=paste(Study.Case, Low.LUI,High.LUI,sep="_"), inner2=ES.frame$Case.ID, outer2=ES.frame$Study.ID)
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR, vi=Richness.Log.RR.Var, mods=~1, slab=paste(Study.Case, Low.LUI,High.LUI,sep="_"), inner2=Case.ID, outer2=Study.ID)
detach(ES.frame)
detach(ES.frame)
attach(ES.frame)
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR, vi=Richness.Log.RR.Var, mods=~1, slab=paste(Study.Case, Low.LUI,High.LUI,sep="_"), inner2=Case.ID, outer2=Study.ID)
detach(ES.frame)
Richness.MA.fit <- LMM.MA.fit(yi=ES.frame$Richness.Log.RR, vi=ES.frame$Richness.Log.RR.Var, mods=~1, slab=paste(ES.frame$Study.Case, ES.frame$Low.LUI, ES.frame$High.LUI,sep="_"), inner2=ES.frame$Case.ID, outer2=ES.frame$Study.ID)
rma.mv.fit <- rma.mv(yi=yi, V=vi, mods = mods, random = ~inner2|outer2, struct="CS", data=ES.frame, slab=slab,method="REML", tdist=FALSE, level=95, digits=4, Rscale="cor", sparse=FALSE, verbose=FALSE)
#ratio of ratios
library(metafor)
library(ggplot2)
setwd("C:\\Users\\hoppek\\Documents\\GitHub\\LUBDES_MA") #KG
#setwd("~/Dropbox/SESYNC-UFZ-sDiv-Call Biodiversity and Ecosystem Services/Meta-Analysis/DataAnalysis") #MB
ES.frame = read.csv("Input/ES_table.csv")
#ES.frame <- ES.frame[-which(ES.frame$Study.ID=="4788-Mosquera-Losada2009"),] # Why?
ES.frame.posVar <- ES.frame[ES.frame$Richness.Log.RR.Var>0 & ES.frame$Yield.Log.RR.Var>0,] # restrict analysis to study cases with positive variances
ES.frame <- ES.frame.posVar
LMM.MA.fit <- function(yi,vi,mods,slab,inner2,outer2){
##############################################################################################################
# TO DO: calculate variance-covariance matrix, esp covariance for between LUI comparisons
#  VCov_matrix <-
rma.mv.fit <- rma.mv(yi=yi, V=vi, mods = mods, random = ~inner2|outer2, struct="CS", data=ES.frame, slab=slab,method="REML", tdist=FALSE, level=95, digits=4, Rscale="cor", sparse=FALSE, verbose=FALSE)
return(rma.mv.fit)
}
attach(ES.frame)
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR, vi=Richness.Log.RR.Var, mods=~1, slab=paste(Study.Case, Low.LUI,High.LUI,sep="_"), inner2=ES.frame$Case.ID, outer2=ES.frame$Study.ID)
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR, vi=Richness.Log.RR.Var, mods=~1, slab=paste(Study.Case, Low.LUI,High.LUI,sep="_"), inner2=Case.ID, outer2=ES.frame$Study.ID)
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR, vi=Richness.Log.RR.Var, mods=~1, slab=paste(Study.Case, Low.LUI,High.LUI,sep="_"), inner2=1, outer2=ES.frame$Study.ID)
inner2=ES.frame$Case.ID
yi=Richness.Log.RR
vi=Richness.Log.RR.Var
mods=~1
slab=paste(Study.Case, Low.LUI,High.LUI,sep="_")
outer2=ES.frame$Study.ID
rma.mv.fit <- rma.mv(yi=yi, V=vi, mods = mods, random = ~inner2|outer2, struct="CS", data=ES.frame, slab=slab,method="REML", tdist=FALSE, level=95, digits=4, Rscale="cor", sparse=FALSE, verbose=FALSE)
rma.mv.fit <- rma.mv(yi=yi, V=vi, mods = mods, random = ~factor(inner2)|factor(outer2), struct="CS", data=ES.frame, slab=slab,method="REML", tdist=FALSE, level=95, digits=4, Rscale="cor", sparse=FALSE, verbose=FALSE)
LMM.MA.fit <- function(yi,vi,mods,slab,inner2,outer2){
##############################################################################################################
# TO DO: calculate variance-covariance matrix, esp covariance for between LUI comparisons
#  VCov_matrix <-
rma.mv.fit <- rma.mv(yi=yi, V=vi, mods = mods, random = ~factor(inner2)|factor(outer2), struct="CS", data=ES.frame, slab=slab,method="REML", tdist=FALSE, level=95, digits=4, Rscale="cor", sparse=FALSE, verbose=FALSE)
return(rma.mv.fit)
}
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR, vi=Richness.Log.RR.Var, mods=~1, slab=paste(Study.Case, Low.LUI,High.LUI,sep="_"), inner2=ES.frame$Case.ID, outer2=ES.frame$Study.ID)
Yield.MA.fit <- LMM.MA.fit(yi=Yield.Log.RR,vi=Yield.Log.RR.Var,mods=~1,slab=paste(Study.Case,Low.LUI,High.LUI,sep="_"),inner=Study.Case,outer=Study.ID)
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR, vi=Richness.Log.RR.Var, mods=~1, slab=paste(Study.Case, Low.LUI,High.LUI,sep="_"), inner2=Case.ID, outer2=Study.ID)
detach(ES.frame)
save(mods,Richness.MA.fit,Yield.MA.fit, file="Output/MA_model_1.Rdata")
MA.coeffs <- data.frame(Moderator="None",levels=1,mean.Richness=Richness.MA.fit$b,se.Richness=Richness.MA.fit$se,mean.Yield=Yield.MA.fit$b,se.Yield=Yield.MA.fit$se)
moderator.list <- c("Habitat.Type","Species.Group","Trophic.Level","LUI.comparison","Study.Type")
moderator.list <- c("Land.use...land.cover","Species.Group","Trophic.Level","LUI.range","Study.Type")
mods <- "LUI.range"
attach(ES.frame)
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR,vi=Richness.Log.RR.Var,mods=as.formula(paste("~",mods,"-1",sep="")),slab=paste(Study.Case,Low.LUI,High.LUI,sep="_"),inner=Study.Case,outer=Study.ID)
Yield.MA.fit <- LMM.MA.fit(yi=Yield.Log.RR,vi=Yield.Log.RR.Var,mods=as.formula(paste("~",mods,"-1",sep="")),slab=paste(Study.Case,Low.LUI,High.LUI,sep="_"),inner=Study.Case,outer=Study.ID)
detach(ES.frame)
MA.coeffs <- rbind(MA.coeffs,data.frame(Moderator=rep(mods,length(Richness.MA.fit$b)),levels=unlist(lapply(strsplit(rownames(Richness.MA.fit$b),mods),function(x){x[[2]]})),mean.Richness=Richness.MA.fit$b,se.Richness=Richness.MA.fit$se,mean.Yield=Yield.MA.fit$b,se.Yield=Yield.MA.fit$se))
strsplit(rownames(Richness.MA.fit$b),mods)
rownames(Richness.MA.fit$b)
ES.frame$LUI.range <- factor(ES.frame$LUI.range)
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR,vi=Richness.Log.RR.Var,mods=as.formula(paste("~",mods,"-1",sep="")),slab=paste(Study.Case,Low.LUI,High.LUI,sep="_"),inner=Study.Case,outer=Study.ID)
Yield.MA.fit <- LMM.MA.fit(yi=Yield.Log.RR,vi=Yield.Log.RR.Var,mods=as.formula(paste("~",mods,"-1",sep="")),slab=paste(Study.Case,Low.LUI,High.LUI,sep="_"),inner=Study.Case,outer=Study.ID)
attach(ES.frame)
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR,vi=Richness.Log.RR.Var,mods=as.formula(paste("~",mods,"-1",sep="")),slab=paste(Study.Case,Low.LUI,High.LUI,sep="_"),inner=Study.Case,outer=Study.ID)
Yield.MA.fit <- LMM.MA.fit(yi=Yield.Log.RR,vi=Yield.Log.RR.Var,mods=as.formula(paste("~",mods,"-1",sep="")),slab=paste(Study.Case,Low.LUI,High.LUI,sep="_"),inner=Study.Case,outer=Study.ID)
detach(ES.frame)
MA.coeffs <- rbind(MA.coeffs,data.frame(Moderator=rep(mods,length(Richness.MA.fit$b)),levels=unlist(lapply(strsplit(rownames(Richness.MA.fit$b),mods),function(x){x[[2]]})),mean.Richness=Richness.MA.fit$b,se.Richness=Richness.MA.fit$se,mean.Yield=Yield.MA.fit$b,se.Yield=Yield.MA.fit$se))
print(MA.coeffs)
save(mods,Richness.MA.fit,Yield.MA.fit, file=paste("Output/MA_model_",mods,".Rdata",sep=""))
MA.coeffs <- data.frame(Moderator="None",levels=1,mean.Richness=Richness.MA.fit$b,se.Richness=Richness.MA.fit$se,mean.Yield=Yield.MA.fit$b,se.Yield=Yield.MA.fit$se)
moderator.list <- c("Land.use...land.cover","Species.Group","Trophic.Level","LUI.range","Study.Type")
for(mods in moderator.list){
print(mods)
attach(ES.frame)
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR,vi=Richness.Log.RR.Var,mods=as.formula(paste("~",mods,"-1",sep="")),slab=paste(Study.Case,Low.LUI,High.LUI,sep="_"),inner=Study.Case,outer=Study.ID)
Yield.MA.fit <- LMM.MA.fit(yi=Yield.Log.RR,vi=Yield.Log.RR.Var,mods=as.formula(paste("~",mods,"-1",sep="")),slab=paste(Study.Case,Low.LUI,High.LUI,sep="_"),inner=Study.Case,outer=Study.ID)
detach(ES.frame)
MA.coeffs <- rbind(MA.coeffs,data.frame(Moderator=rep(mods,length(Richness.MA.fit$b)),levels=unlist(lapply(strsplit(rownames(Richness.MA.fit$b),mods),function(x){x[[2]]})),mean.Richness=Richness.MA.fit$b,se.Richness=Richness.MA.fit$se,mean.Yield=Yield.MA.fit$b,se.Yield=Yield.MA.fit$se))
print(MA.coeffs)
save(mods,Richness.MA.fit,Yield.MA.fit, file=paste("Output/MA_model_",mods,".Rdata",sep=""))
}
MA.coeffs <- data.frame(Moderator="None",levels=1,mean.Richness=Richness.MA.fit$b,se.Richness=Richness.MA.fit$se,mean.Yield=Yield.MA.fit$b,se.Yield=Yield.MA.fit$se)
moderator.list <- c("Land.use...land.cover","Species.Group","Trophic.Level","LUI.range")
for(mods in moderator.list){
print(mods)
attach(ES.frame)
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR,vi=Richness.Log.RR.Var,mods=as.formula(paste("~",mods,"-1",sep="")),slab=paste(Study.Case,Low.LUI,High.LUI,sep="_"),inner=Study.Case,outer=Study.ID)
Yield.MA.fit <- LMM.MA.fit(yi=Yield.Log.RR,vi=Yield.Log.RR.Var,mods=as.formula(paste("~",mods,"-1",sep="")),slab=paste(Study.Case,Low.LUI,High.LUI,sep="_"),inner=Study.Case,outer=Study.ID)
detach(ES.frame)
MA.coeffs <- rbind(MA.coeffs,data.frame(Moderator=rep(mods,length(Richness.MA.fit$b)),levels=unlist(lapply(strsplit(rownames(Richness.MA.fit$b),mods),function(x){x[[2]]})),mean.Richness=Richness.MA.fit$b,se.Richness=Richness.MA.fit$se,mean.Yield=Yield.MA.fit$b,se.Yield=Yield.MA.fit$se))
print(MA.coeffs)
save(mods,Richness.MA.fit,Yield.MA.fit, file=paste("Output/MA_model_",mods,".Rdata",sep=""))
}
detach(ES.frame)
detach(ES.frame)
detach(ES.frame)
MA.coeffs <- data.frame(Moderator="None",levels=1,mean.Richness=Richness.MA.fit$b,se.Richness=Richness.MA.fit$se,mean.Yield=Yield.MA.fit$b,se.Yield=Yield.MA.fit$se)
moderator.list <- c("Land.use...land.cover","Species.Group","Trophic.Level","LUI.range")
for(mods in moderator.list){
print(mods)
attach(ES.frame)
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR,vi=Richness.Log.RR.Var,mods=as.formula(paste("~",mods,"-1",sep="")),slab=paste(Study.Case,Low.LUI,High.LUI,sep="_"),inner=Study.Case,outer=Study.ID)
Yield.MA.fit <- LMM.MA.fit(yi=Yield.Log.RR,vi=Yield.Log.RR.Var,mods=as.formula(paste("~",mods,"-1",sep="")),slab=paste(Study.Case,Low.LUI,High.LUI,sep="_"),inner=Study.Case,outer=Study.ID)
detach(ES.frame)
MA.coeffs <- rbind(MA.coeffs,data.frame(Moderator=rep(mods,length(Richness.MA.fit$b)),levels=unlist(lapply(strsplit(rownames(Richness.MA.fit$b),mods),function(x){x[[2]]})),mean.Richness=Richness.MA.fit$b,se.Richness=Richness.MA.fit$se,mean.Yield=Yield.MA.fit$b,se.Yield=Yield.MA.fit$se))
print(MA.coeffs)
save(mods,Richness.MA.fit,Yield.MA.fit, file=paste("Output/MA_model_",mods,".Rdata",sep=""))
}
write.csv(MA.coeffs, file="Output/MA.coeffs.csv",row.names=F)
##################################
## set the stage
library(metafor)
library(ggplot2)
library(scales)
setwd("C:\\Users\\hoppek\\Documents\\GitHub\\LUBDES_MA") #KG
#load data
ES.frame <- read.csv("ES_table.csv")
MA.coeffs = read.csv("Output\\MA.coeffs.csv")
ES.frame = read.csv("Input/ES_table.csv")
ES.frame.posVar <- ES.frame[ES.frame$Richness.Log.RR.Var>0 & ES.frame$Yield.Log.RR.Var>0,] # restrict analysis to study cases with positive variances
ES.frame <- ES.frame.posVar
ES.frame$LUI.range <- factor(ES.frame$LUI.range)
#plot all in one rush
for(choose.moderator in as.character(unique(MA.coeffs$Moderator))){
ES.moderator.subset = subset(MA.coeffs, Moderator %in% choose.moderator)
ES.moderator.subset$Moderator = factor(ES.moderator.subset$Moderator)
ES.moderator.subset$levels = factor(ES.moderator.subset$levels)
if(nrow(ES.moderator.subset) >= 2){
pdf(paste("Ouput/Cross_diagram_",choose.moderator,".pdf",sep=""),width=15,height=8)
plot =   ggplot() +
geom_blank(data=ES.frame,aes(x=Yield.Log.RR,y=Richness.Log.RR),) +
geom_point(data=ES.frame,aes(x=Yield.Log.RR,y=Richness.Log.RR,color=as.factor(ES.frame[,which(names(ES.frame) %in% choose.moderator)])),size=3.5) +
geom_pointrange(data=ES.moderator.subset,aes(x=mean.Yield, y=mean.Richness	, ymin=mean.Richness	 - (1.96*se.Richness), ymax=mean.Richness	 + (1.96*se.Richness),color=factor(levels)),size=1) +
geom_segment(data=ES.moderator.subset,aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield),y = mean.Richness	, yend = mean.Richness	,color=factor(levels)),size=1) +
geom_hline(data=ES.frame,x=0,linetype="twodash") + geom_vline(data=ES.frame,y=0,linetype="twodash") +
#    scale_fill_discrete(name="paste") +
scale_y_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp",comma_format(digits=2))) +
ylab("RR (Species Richness)") + xlab("RR (Yield)")  + scale_colour_brewer(palette="Set1")
print(plot)
dev.off()
}
if(nrow(ES.moderator.subset) == 1){
pdf(paste("Output/Cross_diagram_",choose.moderator,".pdf",sep=""),width=15,height=8)
ggplot() +
geom_blank(data=ES.frame,aes(x=Yield.Log.RR,y=Richness.Log.RR)) +
geom_point(data=ES.frame,aes(x=Yield.Log.RR,y=Richness.Log.RR),color="grey",size=3.5) +
geom_pointrange(data=ES.moderator.subset,aes(x=mean.Yield, y=mean.Richness  , ymin=mean.Richness	 - (1.96*se.Richness), ymax=mean.Richness	 + (1.96*se.Richness)),color="green",size=1) +
geom_segment(data=ES.moderator.subset,aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield),y = mean.Richness	, yend = mean.Richness),color="green",size=1) +
geom_hline(data=ES.frame,x=0,linetype="twodash") + geom_vline(data=ES.frame,y=0,linetype="twodash") +
#    scale_fill_discrete(name="paste") +
scale_y_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp",comma_format(digits=2))) +
ylab("RR (Species Richness)") + xlab("RR (Yield)")  + scale_colour_brewer(palette="Set1")
print(plot)
dev.off()
}
}
for(choose.moderator in as.character(unique(MA.coeffs$Moderator))){
ES.moderator.subset = subset(MA.coeffs, Moderator %in% choose.moderator)
ES.moderator.subset$Moderator = factor(ES.moderator.subset$Moderator)
ES.moderator.subset$levels = factor(ES.moderator.subset$levels)
if(nrow(ES.moderator.subset) >= 2){
pdf(paste("Output/Cross_diagram_",choose.moderator,".pdf",sep=""),width=15,height=8)
plot =   ggplot() +
geom_blank(data=ES.frame,aes(x=Yield.Log.RR,y=Richness.Log.RR),) +
geom_point(data=ES.frame,aes(x=Yield.Log.RR,y=Richness.Log.RR,color=as.factor(ES.frame[,which(names(ES.frame) %in% choose.moderator)])),size=3.5) +
geom_pointrange(data=ES.moderator.subset,aes(x=mean.Yield, y=mean.Richness	, ymin=mean.Richness	 - (1.96*se.Richness), ymax=mean.Richness	 + (1.96*se.Richness),color=factor(levels)),size=1) +
geom_segment(data=ES.moderator.subset,aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield),y = mean.Richness	, yend = mean.Richness	,color=factor(levels)),size=1) +
geom_hline(data=ES.frame,x=0,linetype="twodash") + geom_vline(data=ES.frame,y=0,linetype="twodash") +
#    scale_fill_discrete(name="paste") +
scale_y_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp",comma_format(digits=2))) +
ylab("RR (Species Richness)") + xlab("RR (Yield)")  + scale_colour_brewer(palette="Set1")
print(plot)
dev.off()
}
if(nrow(ES.moderator.subset) == 1){
pdf(paste("Output/Cross_diagram_",choose.moderator,".pdf",sep=""),width=15,height=8)
ggplot() +
geom_blank(data=ES.frame,aes(x=Yield.Log.RR,y=Richness.Log.RR)) +
geom_point(data=ES.frame,aes(x=Yield.Log.RR,y=Richness.Log.RR),color="grey",size=3.5) +
geom_pointrange(data=ES.moderator.subset,aes(x=mean.Yield, y=mean.Richness  , ymin=mean.Richness	 - (1.96*se.Richness), ymax=mean.Richness	 + (1.96*se.Richness)),color="green",size=1) +
geom_segment(data=ES.moderator.subset,aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield),y = mean.Richness	, yend = mean.Richness),color="green",size=1) +
geom_hline(data=ES.frame,x=0,linetype="twodash") + geom_vline(data=ES.frame,y=0,linetype="twodash") +
#    scale_fill_discrete(name="paste") +
scale_y_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp",comma_format(digits=2))) +
ylab("RR (Species Richness)") + xlab("RR (Yield)")  + scale_colour_brewer(palette="Set1")
print(plot)
dev.off()
}
}
choose.moderator <- "LUI.range"
ES.moderator.subset = subset(MA.coeffs, Moderator %in% choose.moderator)
ES.moderator.subset$Moderator = factor(ES.moderator.subset$Moderator)
ES.moderator.subset$levels = factor(ES.moderator.subset$levels)
if(nrow(ES.moderator.subset) >= 2){
pdf(paste("Output/Cross_diagram_",choose.moderator,".pdf",sep=""),width=15,height=8)
plot =   ggplot() +
geom_blank(data=ES.frame,aes(x=Yield.Log.RR,y=Richness.Log.RR),) +
geom_point(data=ES.frame,aes(x=Yield.Log.RR,y=Richness.Log.RR,color=as.factor(ES.frame[,which(names(ES.frame) %in% choose.moderator)])),size=3.5) +
geom_pointrange(data=ES.moderator.subset,aes(x=mean.Yield, y=mean.Richness	, ymin=mean.Richness	 - (1.96*se.Richness), ymax=mean.Richness	 + (1.96*se.Richness),color=factor(levels)),size=1) +
geom_segment(data=ES.moderator.subset,aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield),y = mean.Richness	, yend = mean.Richness	,color=factor(levels)),size=1) +
geom_hline(data=ES.frame,x=0,linetype="twodash") + geom_vline(data=ES.frame,y=0,linetype="twodash") +
#    scale_fill_discrete(name="paste") +
scale_y_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp",comma_format(digits=2))) +
ylab("RR (Species Richness)") + xlab("RR (Yield)")  + scale_colour_brewer(palette="Set1")
print(plot)
dev.off()
}
as.character(unique(MA.coeffs$Moderator)
)
ES.moderator.subset <- subset(MA.coeffs, Moderator %in% choose.moderator)
ES.moderator.subset$Moderator <- factor(ES.moderator.subset$Moderator)
ES.moderator.subset$levels <- factor(ES.moderator.subset$levels)
if(nrow(ES.moderator.subset) >= 2){
plot <- ggplot() +
geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR),) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR, color=as.factor(ES.frame[,which(names(ES.frame) %in% choose.moderator)])), size=3.5) +
geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness - (1.96*se.Richness), ymax=mean.Richness + (1.96*se.Richness),color=factor(levels)), size=1) +
geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness, color=factor(levels)),size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") + geom_vline(data=ES.frame, y=0, linetype="twodash") +
#    scale_fill_discrete(name="paste") +
scale_y_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)") + labs(fill=choose.moderator)
print(plot)
ggsave(plot, file = paste("Output/Cross_diagram_",choose.moderator,".png",sep=""), width = 15, height = 8, type = "cairo-png")
}
plot <- ggplot() +
geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR),) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR, color=as.factor(ES.frame[,which(names(ES.frame) %in% choose.moderator)])), size=3.5) +
geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness - (1.96*se.Richness), ymax=mean.Richness + (1.96*se.Richness),color=factor(levels)), size=1) +
geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness, color=factor(levels)),size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") + geom_vline(data=ES.frame, y=0, linetype="twodash") +
#    scale_fill_discrete(name="paste") +
scale_y_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)") + labs(fill=paste(choose.moderator))
print(plot)
dev.off()
print(plot)
paste(choose.moderator)
plot <- ggplot() +
geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR),) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR, color=as.factor(ES.frame[,which(names(ES.frame) %in% choose.moderator)])), size=3.5) +
geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness - (1.96*se.Richness), ymax=mean.Richness + (1.96*se.Richness),color=factor(levels)), size=1) +
geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness, color=factor(levels)),size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") + geom_vline(data=ES.frame, y=0, linetype="twodash") +
scale_fill_discrete(name=choose.moderator) +
scale_y_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)")
print(plot)
plot <- ggplot() +
#      geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR),) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR, color=as.factor(ES.frame[,which(names(ES.frame) %in% choose.moderator)])), size=3.5) +
geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness - (1.96*se.Richness), ymax=mean.Richness + (1.96*se.Richness),color=factor(levels)), size=1) +
geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness, color=factor(levels)),size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") + geom_vline(data=ES.frame, y=0, linetype="twodash") +
scale_fill_discrete(name=choose.moderator) +
scale_y_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)")
print(plot)
choose.moderator
plot <- ggplot() +
#      geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR),) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR, color=as.factor(ES.frame[,which(names(ES.frame) %in% choose.moderator)])), size=3.5) +
geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness - (1.96*se.Richness), ymax=mean.Richness + (1.96*se.Richness),color=factor(levels)), size=1) +
geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness, color=factor(levels)),size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") + geom_vline(data=ES.frame, y=0, linetype="twodash") +
scale_fill_discrete(name=paste(choose.moderator)) +
scale_y_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)")
print(plot)
plot <- ggplot() +
#      geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR),) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR, color=as.factor(ES.frame[,which(names(ES.frame) %in% choose.moderator)])), size=3.5) +
geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness - (1.96*se.Richness), ymax=mean.Richness + (1.96*se.Richness),color=factor(levels)), size=1) +
geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness, color=factor(levels)),size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") + geom_vline(data=ES.frame, y=0, linetype="twodash") +
#scale_fill_discrete(name=paste(choose.moderator)) +
scale_y_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)") + labs(color=choose.moderator)
print(plot)
for(choose.moderator in as.character(unique(MA.coeffs$Moderator))){
ES.moderator.subset <- subset(MA.coeffs, Moderator %in% choose.moderator)
ES.moderator.subset$Moderator <- factor(ES.moderator.subset$Moderator)
ES.moderator.subset$levels <- factor(ES.moderator.subset$levels)
if(nrow(ES.moderator.subset) >= 2){
plot <- ggplot() +
#      geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR),) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR, color=as.factor(ES.frame[,which(names(ES.frame) %in% choose.moderator)])), size=3.5) +
geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness - (1.96*se.Richness), ymax=mean.Richness + (1.96*se.Richness),color=factor(levels)), size=1) +
geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness, color=factor(levels)),size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") + geom_vline(data=ES.frame, y=0, linetype="twodash") +
#scale_fill_discrete(name=paste(choose.moderator)) +
scale_y_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)") + labs(color=choose.moderator)
print(plot)
ggsave(plot, file = paste("Output/Cross_diagram_",choose.moderator,".png",sep=""), width = 15, height = 8, type = "cairo-png")
}
if(nrow(ES.moderator.subset) == 1){
ggplot() +
geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR)) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR), color="grey", size=3.5) +
geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness	- (1.96*se.Richness), ymax=mean.Richness	+ (1.96*se.Richness)), color="green", size=1) +
geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness), color="green", size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") +
geom_vline(data=ES.frame, y=0, linetype="twodash") +
#scale_fill_discrete(name="paste") +
scale_y_continuous(labels=trans_format("exp", comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp", comma_format(digits=2))) +
scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)") + guides(fill=FALSE)
print(plot)
ggsave(plot, file = paste("Output/Cross_diagram_",choose.moderator,".png",sep=""), width = 15, height = 8, type = "cairo-png")
}
}
choose.moderator <- "None"
ggplot() +
#      geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR)) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR), color="grey", size=3.5) +
geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness	- (1.96*se.Richness), ymax=mean.Richness	+ (1.96*se.Richness)), color="green", size=1) +
geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness), color="green", size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") +
geom_vline(data=ES.frame, y=0, linetype="twodash") +
#scale_fill_discrete(name="paste") +
scale_y_continuous(labels=trans_format("exp", comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp", comma_format(digits=2))) +
scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)") + guides(fill=FALSE)
print(plot)
ggplot() +
#      geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR)) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR), color="grey", size=3.5) +
geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness	- (1.96*se.Richness), ymax=mean.Richness	+ (1.96*se.Richness)), color="green", size=1) +
geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness), color="green", size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") +
geom_vline(data=ES.frame, y=0, linetype="twodash") +
#scale_fill_discrete(name="paste") +
scale_y_continuous(labels=trans_format("exp", comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp", comma_format(digits=2))) +
#      scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)") + guides(fill=FALSE)
print(plot)
ES.moderator.subset <- subset(MA.coeffs, Moderator %in% choose.moderator)
ES.moderator.subset$Moderator <- factor(ES.moderator.subset$Moderator)
ES.moderator.subset$levels <- factor(ES.moderator.subset$levels)
ggplot() +
#      geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR)) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR), color="grey", size=3.5) +
geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness	- (1.96*se.Richness), ymax=mean.Richness	+ (1.96*se.Richness)), color="green", size=1) +
geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness), color="green", size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") +
geom_vline(data=ES.frame, y=0, linetype="twodash") +
#scale_fill_discrete(name="paste") +
scale_y_continuous(labels=trans_format("exp", comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp", comma_format(digits=2))) +
#      scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)") + guides(fill=FALSE)
print(plot)
View(MA.coeffs)
attach(ES.frame)
Richness.MA.fit <- LMM.MA.fit(yi=Richness.Log.RR, vi=Richness.Log.RR.Var, mods=~1, slab=paste(Study.Case, Low.LUI,High.LUI,sep="_"), inner2=Case.ID, outer2=Study.ID)
Richness.MA.fit$b
detach(ES.frame)
source('~/GitHub/LUBDES_MA/RScripts/02_DataAnalysis.R', echo=TRUE)
View(MA.coeffs)
library(metafor)
library(ggplot2)
library(scales)
setwd("C:\\Users\\hoppek\\Documents\\GitHub\\LUBDES_MA") #KG
### load data
ES.frame <- read.csv("ES_table.csv")
MA.coeffs = read.csv("Output\\MA.coeffs.csv")
ES.frame = read.csv("Input/ES_table.csv")
ES.frame.posVar <- ES.frame[ES.frame$Richness.Log.RR.Var>0 & ES.frame$Yield.Log.RR.Var>0,] # restrict analysis to study cases with positive variances
ES.frame <- ES.frame.posVar
ES.frame$LUI.range <- factor(ES.frame$LUI.range)
#choose.moderator <- "Trophic.Level"
#ES.moderator.subset <- subset(MA.coeffs, moderator %in% choose.moderator)
#plot all in one rush
for(choose.moderator in as.character(unique(MA.coeffs$Moderator))){
ES.moderator.subset <- subset(MA.coeffs, Moderator %in% choose.moderator)
ES.moderator.subset$Moderator <- factor(ES.moderator.subset$Moderator)
ES.moderator.subset$levels <- factor(ES.moderator.subset$levels)
if(nrow(ES.moderator.subset) >= 2){
plot <- ggplot() +
#      geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR),) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR, color=as.factor(ES.frame[,which(names(ES.frame) %in% choose.moderator)])), size=3.5) +
geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness - (1.96*se.Richness), ymax=mean.Richness + (1.96*se.Richness),color=factor(levels)), size=1) +
geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness, color=factor(levels)),size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") + geom_vline(data=ES.frame, y=0, linetype="twodash") +
#scale_fill_discrete(name=paste(choose.moderator)) +
scale_y_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)") + labs(color=choose.moderator)
print(plot)
}
if(nrow(ES.moderator.subset) == 1){
ggplot() +
#      geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR)) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR), color="grey", size=3.5) +
geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness	- (1.96*se.Richness), ymax=mean.Richness	+ (1.96*se.Richness)), color="green", size=1) +
geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness), color="green", size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") +
geom_vline(data=ES.frame, y=0, linetype="twodash") +
#scale_fill_discrete(name="paste") +
scale_y_continuous(labels=trans_format("exp", comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp", comma_format(digits=2))) +
#      scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)") + guides(fill=FALSE)
print(plot)
}
ggsave(plot, file = paste("Output/Cross_diagram_",choose.moderator,".png",sep=""), width = 15, height = 8, type = "cairo-png")
}
choose.moderator <- "None"
ES.moderator.subset <- subset(MA.coeffs, Moderator %in% choose.moderator)
ES.moderator.subset$Moderator <- factor(ES.moderator.subset$Moderator)
ES.moderator.subset$levels <- factor(ES.moderator.subset$levels)
ggplot() +
#      geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR)) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR), color="grey", size=3.5) +
geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness	- (1.96*se.Richness), ymax=mean.Richness	+ (1.96*se.Richness)), color="green", size=1) +
geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness), color="green", size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") +
geom_vline(data=ES.frame, y=0, linetype="twodash") +
#scale_fill_discrete(name="paste") +
scale_y_continuous(labels=trans_format("exp", comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp", comma_format(digits=2))) +
#      scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)") + guides(fill=FALSE)
print(plot)
ggplot() +
#      geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR)) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR), color="grey", size=3.5) +
#      geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness	- (1.96*se.Richness), ymax=mean.Richness	+ (1.96*se.Richness)), color="green", size=1) +
#      geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness), color="green", size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") +
geom_vline(data=ES.frame, y=0, linetype="twodash") +
#scale_fill_discrete(name="paste") +
#      scale_y_continuous(labels=trans_format("exp", comma_format(digits=2))) +
#      scale_x_continuous(labels=trans_format("exp", comma_format(digits=2))) +
#      scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)") + guides(fill=FALSE)
print(plot)
View(ES.moderator.subset)
mode(ES.frame.subset)
mode(ES.moderator.subset)
as.dataframe(ES.moderator.subset)
ES.moderator.subset <- as.data.frame(ES.moderator.subset)
mode(ES.moderator.subset)
ES.moderator.subset$mean.Richness
for(choose.moderator in as.character(unique(MA.coeffs$Moderator))[-1]){
ES.moderator.subset <- subset(MA.coeffs, Moderator %in% choose.moderator)
ES.moderator.subset$Moderator <- factor(ES.moderator.subset$Moderator)
ES.moderator.subset$levels <- factor(ES.moderator.subset$levels)
if(nrow(ES.moderator.subset) >= 2){
plot <- ggplot() +
#      geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR),) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR, color=as.factor(ES.frame[,which(names(ES.frame) %in% choose.moderator)])), size=3.5) +
geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness - (1.96*se.Richness), ymax=mean.Richness + (1.96*se.Richness),color=factor(levels)), size=1) +
geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness, color=factor(levels)),size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") + geom_vline(data=ES.frame, y=0, linetype="twodash") +
#scale_fill_discrete(name=paste(choose.moderator)) +
scale_y_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_x_continuous(labels=trans_format("exp",comma_format(digits=2))) +
scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)") + labs(color=choose.moderator)
print(plot)
}
if(nrow(ES.moderator.subset) == 1){
ggplot() +
#      geom_blank(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR)) +
geom_point(data=ES.frame, aes(x=Yield.Log.RR, y=Richness.Log.RR), color="grey", size=3.5) +
#      geom_pointrange(data=ES.moderator.subset, aes(x=mean.Yield, y=mean.Richness, ymin=mean.Richness	- (1.96*se.Richness), ymax=mean.Richness	+ (1.96*se.Richness)), color="green", size=1) +
#      geom_segment(data=ES.moderator.subset, aes(x=mean.Yield - (1.96*se.Yield), xend=mean.Yield + (1.96*se.Yield), y = mean.Richness, yend = mean.Richness), color="green", size=1) +
geom_hline(data=ES.frame, x=0, linetype="twodash") +
geom_vline(data=ES.frame, y=0, linetype="twodash") +
#scale_fill_discrete(name="paste") +
#      scale_y_continuous(labels=trans_format("exp", comma_format(digits=2))) +
#      scale_x_continuous(labels=trans_format("exp", comma_format(digits=2))) +
#      scale_colour_brewer(palette="Set1") +
ylab("RR (Species Richness)") + xlab("RR (Yield)") + guides(fill=FALSE)
print(plot)
}
ggsave(plot, file = paste("Output/Cross_diagram_",choose.moderator,".png",sep=""), width = 15, height = 8, type = "cairo-png")
}
